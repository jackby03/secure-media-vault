spring:
  application:
    name: secure-media-vault
  main:
    web-application-type: reactive
  r2dbc:
    url: r2dbc:postgresql://db:5432/management
    host: db
    port: 5432
    database: management
    username: postgres
    password: postgres
    pool:
      enabled: true
      initial-size: 5
      max-size: 20
      max-idle-time: PT10M
      max-acquire-time: PT30S
      max-create-connection-time: PT30S
      validation-query: SELECT 1
  flyway:
    enabled: true
    url: jdbc:postgresql://db:5432/management
    user: postgres
    password: postgres
    locations: classpath:db/migration
    baseline-on-migrate: true
  data:
    redis:
      host: redis
      port: 6379
  rabbitmq:
    host: rabbitmq
    port: 5672
    username: guest
    password: guest

app:
  cache:
    file-metadata:
      ttl: PT30M  # 30 minutos
      max-size: 1000
      enabled: true
    search-results:
      ttl: PT15M  # 15 minutos
      max-size: 500
      enabled: true
    thumbnails:
      ttl: PT2H   # 2 horas
      max-size: 2000
      enabled: true
    user-files:
      ttl: PT10M  # 10 minutos
      max-size: 100
      enabled: true
  rabbitmq:
    host: rabbitmq
    port: 5672
    username: guest
    password: guest
    virtual-host: /
    exchanges:
      file-events: file.events
      file-events-dlx: file.events.dlx
    queues:
      file-processing: file.processing
      file-processing-dlq: file.processing.dlq
    routing:
      file-uploaded: file.uploaded
      file-processing-started: file.processing.started
      file-processing-completed: file.processing.completed
      file-processing-failed: file.processing.failed

server:
  port: 8080

management:
  endpoints:
    web:
      exposure:
        include: "*"
      base-path: /actuator
  endpoint:
    health:
      show-details: always
    prometheus:
      enabled: true
    metrics:
      enabled: true
  metrics:
    export:
      prometheus:
        enabled: true
    distribution:
      percentiles-histogram:
        "[http.server.requests]": true
    tags:
      application: ${spring.application.name}

minio:
  url: http://minio:9000
  access-key: minioadmin
  secret-key: minioadmin
  bucket-name: secure-media-vault
  connect-timeout: 10000
  write-timeout: 60000
  read-timeout: 10000

logging:
  level:
    root: INFO
    com.acme.vault: INFO
    org:
      springframework:
        web: DEBUG
        web.reactive: DEBUG
        security: DEBUG
        r2dbc:
          core: DEBUG
        data:
          r2dbc: DEBUG
    reactor:
      netty:
        http:
          server: DEBUG
    io:
      netty:
        handler:
          logging: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%logger{36}] - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%logger{36}] - %msg%n"
jwt:
  key: "tu-clave-secreta-aqui-debe-ser-muy-larga-para-ser-segura"
  access-token-expiration: 3600000  # 1 hora
  refresh-token-expiration: 86400000  # 24 horas